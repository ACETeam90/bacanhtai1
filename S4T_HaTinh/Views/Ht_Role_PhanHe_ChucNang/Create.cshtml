@model S4T_HaTinh.Models.Ht_Role_PhanHe_ChucNang
@using S4T_HaTinh.Models;
@{
    var listRole = new SelectList(ViewBag.ListRole,"Id","TenHienThi");
    var listChucNang = new SelectList(ViewBag.ListChucNang, "PhanHeChucNang_ID", "TenChucNang");
}

<h2>Tạo mới</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        <div class="divRow">
            @Html.LabelFor(model => model.RoleId, htmlAttributes: new { @class = "divLabel" })
            <div class="divControl">
                @Html.DropDownListFor(model => model.RoleId, listRole, new { @class = "S4T_ComboBox", @style = "width:250px;", @onchange="ChangeListChucNang()" })
                @Html.ValidationMessageFor(model => model.RoleId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="divRow">
            @Html.LabelFor(model => model.PhanHeChucNang_ID, htmlAttributes: new { @class = "divLabel" })
            <div class="divControl">
                @Html.DropDownListFor(model => model.PhanHeChucNang_ID, listChucNang, new { @class = "S4T_ComboBox", @style = "width:250px;" })
                @Html.ValidationMessageFor(model => model.PhanHeChucNang_ID, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="divRow">
            @Html.LabelFor(model => model.IsView, htmlAttributes: new { @class = "divLabel" })
            <div class="divControl">
                @Html.DropDownListFor(model => model.IsView, MvcApplication.SelectListCoKhong(), new { @class = "S4T_DropDownList" })
                @Html.ValidationMessageFor(model => model.IsView, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="divRow">
            @Html.LabelFor(model => model.IsEdit, htmlAttributes: new { @class = "divLabel" })
            <div class="divControl">
                @Html.DropDownListFor(model => model.IsEdit, MvcApplication.SelectListCoKhong(), new { @class = "S4T_DropDownList" })
                @Html.ValidationMessageFor(model => model.IsEdit, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="divRow">
            <label class="divLabel" id="lbl"></label>
            <div class="divControl">
                <button type="submit" class="k-button k-button-icontext"><span class="k-icon k-i-tick"></span>Lưu</button>
            </div>
        </div>
    </div>
}

<script type="text/javascript">
    $(document).ready(function () {

    });

    function ChangeListChucNang() {
        $.ajax({
            type: 'POST',
            url: "/Ht_Role_PhanHe_ChucNang/ChangeListChucNang?roleId=" + $("#RoleId").val(),
            success: function (data) {
                if (data.msg == null) {
                    $("#PhanHeChucNang_ID").html(data.danhSach);
                    $("#PhanHeChucNang_ID").kendoComboBox({
                        filter: "contains",
                        ignoreCase: true
                    });
                } else {
                    alert(data.msg);
                }
            }
            //,async: true
        });
    }
</script>

